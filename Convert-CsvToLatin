#sorting_out
$a = Import-Csv .\_.csv -Encoding Default
#morphing
foreach ($item in $a) {
#First Name Morph
$item.FIRSTNAME = $item.FIRSTNAME.Replace("а","a")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("б","b")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("в","v")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("г","g")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("д","d")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("е","e")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("ё","e")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("ж","zh")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("з","z")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("и","i")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("й","i")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("к","k")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("л","l")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("м","m")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("н","n")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("о","o")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("п","p")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("р","r")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("с","s")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("т","t")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("у","u")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("ф","f")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("х","kh")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("ц","ts")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("ч","ch")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("ш","sh")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("щ","shch")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("ъ","ie")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("ы","y")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("ь","")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("э","e")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("ю","iu")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("я","ia")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("А","A")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Б","B")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("В","V")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Г","G")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Д","D")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Е","E")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Ё","E")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Ж","Zh")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("З","Z")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("И","I")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Й","I")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("К","K")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Л","L")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("М","M")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Н","N")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("О","O")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("П","P")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Р","R")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("С","S")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Т","T")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("У","U")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Ф","F")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Х","Kh")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Ц","Ts")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Ч","Ch")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Ш","Sh")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Щ","Shch")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Ъ","Ie")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Ы","Y")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Ь","")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Э","E")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Ю","Iu")
$item.FIRSTNAME = $item.FIRSTNAME.Replace("Я","Ia")

#Last Name Morph
$item.LASTNAME = $item.LASTNAME.Replace("а","a")
$item.LASTNAME = $item.LASTNAME.Replace("б","b")
$item.LASTNAME = $item.LASTNAME.Replace("в","v")
$item.LASTNAME = $item.LASTNAME.Replace("г","g")
$item.LASTNAME = $item.LASTNAME.Replace("д","d")
$item.LASTNAME = $item.LASTNAME.Replace("е","e")
$item.LASTNAME = $item.LASTNAME.Replace("ё","e")
$item.LASTNAME = $item.LASTNAME.Replace("ж","zh")
$item.LASTNAME = $item.LASTNAME.Replace("з","z")
$item.LASTNAME = $item.LASTNAME.Replace("и","i")
$item.LASTNAME = $item.LASTNAME.Replace("й","i")
$item.LASTNAME = $item.LASTNAME.Replace("к","k")
$item.LASTNAME = $item.LASTNAME.Replace("л","l")
$item.LASTNAME = $item.LASTNAME.Replace("м","m")
$item.LASTNAME = $item.LASTNAME.Replace("н","n")
$item.LASTNAME = $item.LASTNAME.Replace("о","o")
$item.LASTNAME = $item.LASTNAME.Replace("п","p")
$item.LASTNAME = $item.LASTNAME.Replace("р","r")
$item.LASTNAME = $item.LASTNAME.Replace("с","s")
$item.LASTNAME = $item.LASTNAME.Replace("т","t")
$item.LASTNAME = $item.LASTNAME.Replace("у","u")
$item.LASTNAME = $item.LASTNAME.Replace("ф","f")
$item.LASTNAME = $item.LASTNAME.Replace("х","kh")
$item.LASTNAME = $item.LASTNAME.Replace("ц","ts")
$item.LASTNAME = $item.LASTNAME.Replace("ч","ch")
$item.LASTNAME = $item.LASTNAME.Replace("ш","sh")
$item.LASTNAME = $item.LASTNAME.Replace("щ","shch")
$item.LASTNAME = $item.LASTNAME.Replace("ъ","ie")
$item.LASTNAME = $item.LASTNAME.Replace("ы","y")
$item.LASTNAME = $item.LASTNAME.Replace("ь","")
$item.LASTNAME = $item.LASTNAME.Replace("э","e")
$item.LASTNAME = $item.LASTNAME.Replace("ю","iu")
$item.LASTNAME = $item.LASTNAME.Replace("я","ia")
$item.LASTNAME = $item.LASTNAME.Replace("А","A")
$item.LASTNAME = $item.LASTNAME.Replace("Б","B")
$item.LASTNAME = $item.LASTNAME.Replace("В","V")
$item.LASTNAME = $item.LASTNAME.Replace("Г","G")
$item.LASTNAME = $item.LASTNAME.Replace("Д","D")
$item.LASTNAME = $item.LASTNAME.Replace("Е","E")
$item.LASTNAME = $item.LASTNAME.Replace("Ё","E")
$item.LASTNAME = $item.LASTNAME.Replace("Ж","Zh")
$item.LASTNAME = $item.LASTNAME.Replace("З","Z")
$item.LASTNAME = $item.LASTNAME.Replace("И","I")
$item.LASTNAME = $item.LASTNAME.Replace("Й","I")
$item.LASTNAME = $item.LASTNAME.Replace("К","K")
$item.LASTNAME = $item.LASTNAME.Replace("Л","L")
$item.LASTNAME = $item.LASTNAME.Replace("М","M")
$item.LASTNAME = $item.LASTNAME.Replace("Н","N")
$item.LASTNAME = $item.LASTNAME.Replace("О","O")
$item.LASTNAME = $item.LASTNAME.Replace("П","P")
$item.LASTNAME = $item.LASTNAME.Replace("Р","R")
$item.LASTNAME = $item.LASTNAME.Replace("С","S")
$item.LASTNAME = $item.LASTNAME.Replace("Т","T")
$item.LASTNAME = $item.LASTNAME.Replace("У","U")
$item.LASTNAME = $item.LASTNAME.Replace("Ф","F")
$item.LASTNAME = $item.LASTNAME.Replace("Х","Kh")
$item.LASTNAME = $item.LASTNAME.Replace("Ц","Ts")
$item.LASTNAME = $item.LASTNAME.Replace("Ч","Ch")
$item.LASTNAME = $item.LASTNAME.Replace("Ш","Sh")
$item.LASTNAME = $item.LASTNAME.Replace("Щ","Shch")
$item.LASTNAME = $item.LASTNAME.Replace("Ъ","Ie")
$item.LASTNAME = $item.LASTNAME.Replace("Ы","Y")
$item.LASTNAME = $item.LASTNAME.Replace("Ь","")
$item.LASTNAME = $item.LASTNAME.Replace("Э","E")
$item.LASTNAME = $item.LASTNAME.Replace("Ю","Iu")
$item.LASTNAME = $item.LASTNAME.Replace("Я","Ia")

#Middle Name Morph
$item.MIDDLENAME = $item.MIDDLENAME.Replace("а","a")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("б","b")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("в","v")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("г","g")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("д","d")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("е","e")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("ё","e")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("ж","zh")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("з","z")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("и","i")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("й","i")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("к","k")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("л","l")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("м","m")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("н","n")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("о","o")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("п","p")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("р","r")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("с","s")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("т","t")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("у","u")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("ф","f")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("х","kh")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("ц","ts")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("ч","ch")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("ш","sh")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("щ","shch")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("ъ","ie")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("ы","y")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("ь","")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("э","e")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("ю","iu")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("я","ia")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("А","A")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Б","B")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("В","V")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Г","G")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Д","D")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Е","E")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Ё","E")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Ж","Zh")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("З","Z")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("И","I")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Й","I")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("К","K")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Л","L")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("М","M")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Н","N")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("О","O")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("П","P")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Р","R")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("С","S")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Т","T")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("У","U")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Ф","F")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Х","Kh")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Ц","Ts")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Ч","Ch")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Ш","Sh")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Щ","Shch")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Ъ","Ie")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Ы","Y")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Ь","")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Э","E")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Ю","Iu")
$item.MIDDLENAME = $item.MIDDLENAME.Replace("Я","Ia")

#Generate UPN
$item.UPN = $item.FIRSTNAME + '.' + $item.LASTNAME + '@xxxxx.ru'

#Generate Password
$RandomPassword = $null
$Private:OFS = ""
$PasswordLength = 8
$InclChars = 'abcdefghkmnprstuvwxyzABCDEFGHKLMNPRSTUVWXYZ123456789!"§$%&/()=?*+#_'
$RandomNums = 1..$PasswordLength | ForEach-Object { Get-Random -Maximum $InclChars.length }
$RandomPassword = [String]$InclChars[$RandomNums]
$item.PASSWORD = $RandomPassword
}

$a | Export-Csv .\_.csv -NoTypeInformation -Force
